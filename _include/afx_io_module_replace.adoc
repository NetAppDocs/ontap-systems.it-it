= Fase 1: Spegnere il nodo compromesso
:allow-uri-read: 


Puoi utilizzare questa procedura con tutte le versioni di ONTAP supportate dal tuo sistema storage.

.Prima di iniziare
* È necessario avere a disposizione il pezzo di ricambio.
* Verificare che tutti gli altri componenti del sistema di archiviazione funzionino correttamente; in caso contrario, contattare l'assistenza tecnica.




== Fase 1: Spegnere il nodo compromesso

Spegnere o sostituire il controller compromesso.

Per arrestare il controller danneggiato, è necessario determinarne lo stato e, se necessario, eseguire un failover di archiviazione del controller in modo che il controller funzionante continui a elaborare i dati dall'archiviazione del controller danneggiato.

.A proposito di questa attività
* Se si dispone di un cluster con più di quattro nodi, è necessario che sia raggiunto il quorum.  Per visualizzare le informazioni del cluster sui nodi, utilizzare `cluster show` comando.  Per maggiori informazioni sul `cluster show` comando, vederelink:https://docs.netapp.com/us-en/ontap/system-admin/display-nodes-cluster-task.html["Visualizza i dettagli a livello di nodo in un cluster ONTAP"^] .
* Se il cluster non è in quorum o se lo stato di integrità o l'idoneità di un qualsiasi controller (diverso dal controller non funzionante) risulta falso, è necessario correggere il problema prima di arrestare il controller non funzionante. Vedere link:https://docs.netapp.com/us-en/ontap/system-admin/synchronize-node-cluster-task.html?q=Quorum["Sincronizzare un nodo con il cluster"^] .


.Fasi
. Se AutoSupport è attivato, eliminare la creazione automatica del caso richiamando un messaggio AutoSupport:
+
`system node autosupport invoke -node * -type all -message MAINT=<# of hours>h`

+
Il seguente messaggio AutoSupport elimina la creazione automatica del caso per due ore:

+
`cluster1:> system node autosupport invoke -node * -type all -message MAINT=2h`

. Disattivare il ritorno automatico dalla console del controllore non abilitato:
+
`storage failover modify -node impaired-node -auto-giveback-of false`

+

NOTE: Quando vedi _Vuoi disattivare la restituzione automatica?_, inserisci `y` .

+
.. Se si utilizza ONTAP versione 9.17.1 e il controller non funzionante non può essere avviato o è già stato preso in carico, è necessario disattivare il collegamento di interconnessione HA dal controller funzionante prima di avviare il controller non funzionante.  Ciò impedisce al controllore compromesso di eseguire la restituzione automatica.
+
`system ha interconnect link off -node healthy-node -link 0`

+
`system ha interconnect link off -node healthy-node -link 1`



. Portare la centralina danneggiata al prompt DEL CARICATORE:
+
[cols="1,2"]
|===
| Se il controller non utilizzato visualizza... | Quindi... 


 a| 
Il prompt DEL CARICATORE
 a| 
Passare alla fase successiva.



 a| 
Prompt di sistema o prompt della password
 a| 
Prendere il controllo o interrompere il controllo del controllore sano da parte del controllore compromesso:
`storage failover takeover -ofnode _impaired_node_name_ -halt _true_`

Il parametro _-halt true_ porta il nodo danneggiato al prompt LOADER.

|===




== Fase 2: Sostituire un modulo i/o guasto

Per sostituire un modulo i/o, individuarlo all'interno del contenitore e seguire la sequenza specifica di passi.


CAUTION: Indossare sempre un braccialetto con messa a terra collegato a un punto di messa a terra verificato durante le procedure di installazione e manutenzione. La mancata osservanza delle opportune precauzioni ESD può causare danni permanenti ai nodi controller, ai ripiani di storage e agli switch di rete.

. Scollegare eventuali cavi dal modulo i/o di destinazione.
+

NOTE: Assicuratevi di etichettare il punto in cui sono stati collegati i cavi, in modo da poterli collegare alle porte corrette quando reinstallate il modulo.

. Ruotare il vassoio di gestione dei cavi verso il basso tirando i pulsanti su entrambi i lati all'interno del vassoio di gestione dei cavi, quindi ruotare il vassoio verso il basso.
+

NOTE: La figura seguente mostra la rimozione di un modulo i/o orizzontale e verticale. In genere, si rimuoverà un solo modulo i/O.

+
image:../media/drw_a1k_io_remove_replace_ieops-1382.svg["Rimuovere il modulo di i/O."]

+
[cols="1,4"]
|===


 a| 
image:../media/icon_round_1.png["Numero di didascalia 1"]
 a| 
Blocco camma i/O.

|===
+
Assicurarsi di etichettare i cavi in modo da conoscerne la provenienza.

. Rimuovere il modulo i/o di destinazione dal contenitore:
+
.. Premere il pulsante CAM sul modulo target.
.. Ruotare il dispositivo di chiusura della camma lontano dal modulo fino in fondo.
.. Rimuovere il modulo dal contenitore agganciando il dito nell'apertura della leva della camma ed estraendo il modulo dal contenitore.
+
Assicurarsi di tenere traccia dello slot in cui si trovava il modulo i/O.



. Mettere da parte il modulo i/O.
. Installare il modulo i/o sostitutivo nel contenitore:
+
.. Allineare il modulo con i bordi dell'apertura dello slot del contenitore.
.. Far scorrere delicatamente il modulo nello slot fino in fondo al contenitore, quindi ruotare il dispositivo di chiusura della camma completamente verso l'alto per bloccare il modulo in posizione.


. Ricollegare il modulo I/O.
. Ruotare il vassoio di gestione dei cavi verso l'alto fino alla posizione di chiusura.




== Fase 3: Riavviare il controller

Dopo aver sostituito un modulo i/o, è necessario riavviare il controller.

. Riavviare il controller dal prompt DEL CARICATORE:
+
`bye`

+

NOTE: Il riavvio del controller danneggiato reinizializza anche i moduli i/o e gli altri componenti.

. Premere <enter> quando i messaggi della console si interrompono.
+
** Se viene visualizzato il prompt _login_, procedere al passaggio successivo.
** Se non vedi il prompt di accesso, accedi al nodo partner.


. Restituisci solo la radice con l'opzione override-destination-checks:
+
`storage failover giveback -ofnode impaired-node -only-root true -override -destination-checks true`

+

NOTE: Il seguente comando è disponibile solo nel livello di privilegio Modalità diagnostica.  Per ulteriori informazioni sui livelli di privilegio, vederelink:https://docs.netapp.com/us-en/ontap/system-admin/administrative-privilege-levels-concept.html["Comprendere i livelli di privilegio per i comandi CLI ONTAP"^] .

+
In caso di errori, contattare https://support.netapp.com["Supporto NetApp"].

. Attendere 5 minuti dopo il completamento del report di sconto e verificare lo stato di failover e dello stato dello sconto:
+
`storage failover show`E `storage failover show-giveback`

+

NOTE: Il seguente comando è disponibile solo nel livello di privilegio Modalità diagnostica.

. Se i collegamenti interconnessi HA sono stati interrotti, ripristinarli:
+
`system ha interconnect link on -node healthy-node -link 0`

+
`system ha interconnect link on -node healthy-node -link 1`

. Se il giveback automatico è stato disattivato, riabilitarlo:
+
`storage failover modify -ofnode impaired-node -automatic-giveback true`

. Riportare la centralina guasta al normale funzionamento restituendo la memoria:
+
`storage failover giveback -ofnode _impaired_node_name_`

. Ripristino del giveback automatico dalla console del controller integro:
+
`storage failover modify -node local -auto-giveback-of true`

. Se AutoSupport è attivato, ripristinare/riattivare la creazione automatica dei casi:
+
`system node autosupport invoke -node * -type all -message MAINT=END`





== Fase 4: Restituire la parte guasta a NetApp

Restituire la parte guasta a NetApp, come descritto nelle istruzioni RMA fornite con il kit. Vedere la https://mysupport.netapp.com/site/info/rma["Restituzione e sostituzione delle parti"] pagina per ulteriori informazioni.
