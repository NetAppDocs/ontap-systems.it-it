---
permalink: afx-1k/rtc-battery-replace.html 
sidebar: sidebar 
keywords: afx 1k, replace the real-time clock battery 
summary: 'Sostituisci la batteria dell"orologio in tempo reale (RTC), comunemente nota come batteria a bottone, nel tuo sistema di archiviazione AFX 1K per garantire che i servizi e le applicazioni che si basano su una sincronizzazione temporale accurata rimangano operativi.' 
---
= Sostituire la batteria dell'orologio in tempo reale - AFX 1K
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Sostituisci la batteria dell'orologio in tempo reale (RTC), comunemente nota come batteria a bottone, nel tuo sistema di archiviazione AFX 1K per garantire che i servizi e le applicazioni che si basano su una sincronizzazione temporale accurata rimangano operativi.

.Prima di iniziare
* Comprendere che è possibile utilizzare questa procedura con tutte le versioni di ONTAP supportate dal sistema.
* Assicurarsi che tutti gli altri componenti del sistema funzionino correttamente; in caso contrario, contattare il supporto tecnico.




== Fase 1: Spegnere il controller compromesso

Arrestare o sostituire il controller compromesso utilizzando una delle seguenti opzioni.

Per arrestare il controller danneggiato, è necessario determinarne lo stato e, se necessario, eseguire un failover di archiviazione del controller in modo che il controller funzionante continui a elaborare i dati dall'archiviazione del controller danneggiato.

.A proposito di questa attività
* Se si dispone di un cluster con più di quattro nodi, è necessario che sia raggiunto il quorum.  Per visualizzare le informazioni del cluster sui nodi, utilizzare `cluster show` comando.  Per maggiori informazioni sul `cluster show` comando, vederelink:https://docs.netapp.com/us-en/ontap/system-admin/display-nodes-cluster-task.html["Visualizza i dettagli a livello di nodo in un cluster ONTAP"^] .
* Se il cluster non è in quorum o se lo stato di integrità o l'idoneità di un qualsiasi controller (diverso dal controller non funzionante) risulta falso, è necessario correggere il problema prima di arrestare il controller non funzionante. Vedere link:https://docs.netapp.com/us-en/ontap/system-admin/synchronize-node-cluster-task.html?q=Quorum["Sincronizzare un nodo con il cluster"^] .


.Fasi
. Se AutoSupport è attivato, eliminare la creazione automatica del caso richiamando un messaggio AutoSupport:
+
`system node autosupport invoke -node * -type all -message MAINT=<# of hours>h`

+
Il seguente messaggio AutoSupport elimina la creazione automatica del caso per due ore:

+
`cluster1:> system node autosupport invoke -node * -type all -message MAINT=2h`

. Disattivare il ritorno automatico dalla console del controllore non abilitato:
+
`storage failover modify -node impaired-node -auto-giveback-of false`

+

NOTE: Quando vedi _Vuoi disattivare la restituzione automatica?_, inserisci `y` .

+
.. Se si utilizza ONTAP versione 9.17.1 e il controller non funzionante non può essere avviato o è già stato preso in carico, è necessario disattivare il collegamento di interconnessione HA dal controller funzionante prima di avviare il controller non funzionante.  Ciò impedisce al controllore compromesso di eseguire la restituzione automatica.
+
`system ha interconnect link off -node healthy-node -link 0`

+
`system ha interconnect link off -node healthy-node -link 1`

+

NOTE: Se non si utilizza la versione 9.17.1 ONTAP , saltare il passaggio precedente e andare al passaggio 3.



. Portare la centralina danneggiata al prompt DEL CARICATORE:
+
[cols="1,2"]
|===
| Se il controller non utilizzato visualizza... | Quindi... 


 a| 
Il prompt DEL CARICATORE
 a| 
Passare alla fase successiva.



 a| 
Prompt di sistema o prompt della password
 a| 
Prendere il controllo o interrompere il controllo del controllore sano da parte del controllore compromesso:
`storage failover takeover -ofnode _impaired_node_name_ -halt _true_`

Il parametro _-halt true_ porta il nodo danneggiato al prompt LOADER.

|===




== Fase 2: Rimuovere il modulo controller

È necessario rimuovere il modulo controller dal contenitore quando si sostituisce il modulo controller o un componente all'interno del modulo controller.

. Controllare il LED di stato NVRAM situato nello slot 4/5 del sistema. Sul pannello anteriore del modulo controller è presente anche un LED NVRAM. Cercare l'icona NV:
+
image::../media/drw_a1K-70-90_nvram-led_ieops-1463.svg[Grafico della posizione dei LED di stato e di attenzione NVRAM]

+
[cols="1,4"]
|===


 a| 
image:../media/icon_round_1.png["Numero di didascalia 1"]
 a| 
LED di stato NVRAM



 a| 
image:../media/icon_round_2.png["Numero di didascalia 2"]
 a| 
LED di attenzione NVRAM

|===
+
** Se il LED NV è spento, passare alla fase successiva.
** Se il LED NV lampeggia, attendere l'arresto del lampeggio. Se il lampeggiamento continua per più di 5 minuti, contattare il supporto tecnico per assistenza.


. Se non si è già collegati a terra, mettere a terra l'utente.
. Rimuovere la lunetta (se necessario) con due mani, afferrando le aperture su ciascun lato della lunetta e tirando verso di sé finché la lunetta non si stacca dai perni sferici sul telaio.
. Sulla parte anteriore dell'unità, agganciare le dita nei fori delle camme di bloccaggio, premere le linguette sulle leve a camma e ruotare delicatamente, ma con decisione, entrambi i fermi verso di sé contemporaneamente.
+
Il modulo controller si sposta leggermente all'esterno del contenitore.

+
image::../media/drw_a1k_pcm_remove_replace_ieops-1375.svg[Immagine di rimozione della centralina]

+
[cols="1,4"]
|===


 a| 
image:../media/icon_round_1.png["Numero di didascalia 1"]
| Blocco dei fermi della camma 
|===
. Estrarre il modulo controller dal contenitore e collocarlo su una superficie piana e stabile.
+
Assicurarsi di sostenere la parte inferiore del modulo controller mentre lo si estrae dal contenitore.





== Fase 3: Sostituire la batteria RTC

Rimuovere la batteria RTC guasta e installare quella sostitutiva.

. Aprire il condotto dell'aria della centralina sulla parte superiore della centralina.
+
.. Inserire le dita nelle cavità alle estremità più lontane del condotto dell'aria.
.. Sollevare il condotto dell'aria e ruotarlo verso l'alto fino in fondo.


. Individuare la batteria RTC sotto il condotto dell'aria.
+
image::../media/drw_a1k_rtc_remove_replace_ieops-1381.svg[Sostituire la batteria RTC]

+
[cols="1,4"]
|===


 a| 
image:../media/icon_round_1.png["Numero di didascalia 1"]
| Batteria e alloggiamento RTC 
|===
. Estrarre delicatamente la batteria dal supporto, ruotarla verso l'esterno, quindi estrarla dal supporto.
+

NOTE: Prestare attenzione alla polarità della batteria quando la si rimuove dal supporto.  La batteria è contrassegnata con un segno più e deve essere posizionata correttamente nel supporto.  Un segno più vicino al supporto indica l'orientamento corretto.

. Rimuovere la batteria di ricambio dalla confezione antistatica per la spedizione.
. Prendere nota della polarità della batteria RTC, quindi inserirla nel supporto inclinandola e spingendola verso il basso.
. Controllare visivamente che la batteria sia completamente installata nel supporto e che la polarità sia corretta.




== Fase 4: Reinstallare il modulo controller

Reinstallare il modulo controller e avviarlo.

. Assicurarsi che il condotto dell'aria sia completamente chiuso ruotandolo verso il basso fino in fondo.
+
Deve essere a filo con la lamiera del modulo controller.

. Allineare l'estremità del modulo controller con l'apertura nel contenitore, quindi far scorrere il modulo controller nel telaio con le leve ruotate lontano dalla parte anteriore del sistema.
. Una volta che il modulo controller non riesce a farlo scorrere ulteriormente, ruotare le maniglie della camma verso l'interno fino a quando non si bloccano sotto le ventole
+

NOTE: Non esercitare una forza eccessiva quando si fa scorrere il modulo controller nel contenitore per evitare di danneggiare i connettori.

+
Il modulo controller inizia ad avviarsi non appena viene inserito completamente nel contenitore.

. Allineare la lunetta con i perni sferici e poi spingere delicatamente la lunetta in posizione.




== Passaggio 5: Reimpostare l'ora e la data sul controller


NOTE: Dopo aver sostituito la batteria RTC, inserito il controller e acceso il primo ripristino del BIOS, verranno visualizzati i seguenti messaggi di errore:
`RTC date/time error. Reset date/time to default`
`RTC power failure error` Questi messaggi sono attesi e puoi continuare con questa procedura.

. Controllare la data e l'ora sul controller sano con il `cluster date show` comando.
+

NOTE: Se il sistema si arresta al menu di avvio, selezionare l'opzione per  `Reboot node` e rispondere _y_ quando richiesto, quindi avviare il CARICATORE premendo _Ctrl-C_

+
.. Al prompt LOADER sul controller di destinazione, controllare l'ora e la data con `show date` comando.
.. Se necessario, modificare la data con `set date mm/dd/yyyy` comando.
.. Se necessario, impostare l'ora, in GMT, utilizzando `set time hh:mm:ss` comando.
+
... È possibile ottenere l'attuale GMT dal nodo partner con `date -u` comando.




. Confermare la data e l'ora sul controller di destinazione.
. Al prompt DEL CARICATORE, immettere `bye` Reinizializzare le schede PCIe e gli altri componenti e lasciare riavviare il controller.
. Premere <enter> quando i messaggi della console si interrompono.
+
** Se viene visualizzato il prompt _login_, procedere al passaggio successivo.
** Se non vedi il prompt di accesso, accedi al nodo partner.


. Restituisci solo la radice con l'opzione override-destination-checks:
+
`storage failover giveback -ofnode impaired-node -only-root true -override -destination-checks true`

+

NOTE: Il seguente comando è disponibile solo nel livello di privilegio Modalità diagnostica.  Per ulteriori informazioni sui livelli di privilegio, vederelink:https://docs.netapp.com/us-en/ontap/system-admin/administrative-privilege-levels-concept.html["Comprendere i livelli di privilegio per i comandi CLI ONTAP"^] .

+
In caso di errori, contattare https://support.netapp.com["Supporto NetApp"].

. Attendi cinque minuti dopo il completamento del report di restituzione, quindi controlla gli stati di failover e restituzione:
+
`storage failover show`E `storage failover show-giveback`

+

NOTE: Il seguente comando è disponibile solo nel livello di privilegio Modalità diagnostica.

. Se i collegamenti interconnessi HA sono stati interrotti, ripristinarli:
+
`system ha interconnect link on -node healthy-node -link 0`

+
`system ha interconnect link on -node healthy-node -link 1`

. Riportare la centralina guasta al normale funzionamento restituendo la memoria:
+
`storage failover giveback -ofnode _impaired_node_name_`

. Se il giveback automatico è stato disattivato, riabilitarlo:
+
`storage failover modify -node local -auto-giveback-of true`

. Se AutoSupport è attivato, ripristinare/riattivare la creazione automatica dei casi:
+
`system node autosupport invoke -node * -type all -message MAINT=END`





== Fase 6: Restituire la parte guasta a NetApp

Restituire la parte guasta a NetApp, come descritto nelle istruzioni RMA fornite con il kit. Vedere la https://mysupport.netapp.com/site/info/rma["Restituzione e sostituzione delle parti"] pagina per ulteriori informazioni.
